files:
  "/etc/nginx/conf.d/https_redirect.conf":
    mode: "000644"
    owner: root
    group: root
    content: |
      # Redirect HTTP to HTTPS when behind ALB
      # ALB sets X-Forwarded-Proto header

      map $http_x_forwarded_proto $redirect_to_https {
        default 0;
        http 1;
      }

container_commands:
  01_reload_nginx:
    command: "systemctl reload nginx || true"
